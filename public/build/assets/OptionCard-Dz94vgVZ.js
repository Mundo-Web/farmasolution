var me=Object.defineProperty;var he=(n,s,t)=>s in n?me(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var q=(n,s,t)=>he(n,typeof s!="symbol"?s+"":s,t);import{c as F}from"./createLucideIcon-DfjclApS.js";import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BOnQTV8N.js";import{S as y}from"./sparkles-DvmvZ6mJ.js";import{M as ye}from"./CartItemRow-CbMdXK40.js";import{P as ge}from"./plus-CTIomuuF.js";import{T as be}from"./trash-2-DU7LB6-f.js";import{a as ve}from"./index-NIGUFBhG.js";import{X as je}from"./x-fof_H3Vv.js";import{a as Ne,b as f,h as we,c as _,d as Se,u as _e,S as ke,_ as Oe}from"./useStateManager-7e1e8489.esm-BASof734.js";import"./index-C0Swrixi.js";import{m as O}from"./main-DKOTUah5.js";import"./index-DRg3WPTA.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=F("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=F("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=F("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Qe=({children:n,className:s="",loading:t=!1,disabled:r=!1,...a})=>e.jsxs("button",{type:"button",disabled:r||t,className:`w-full bg-primary font-bold  py-3 px-4 hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl flex items-center justify-center gap-2 ${s}`,...a,children:[t&&e.jsx(Ce,{className:"w-4 h-4 animate-spin"}),n]}),We=({children:n,className:s="",...t})=>e.jsx("a",{className:`w-full block border-primary cursor-pointer border-2 text-center font-bold customtext-primary py-3 px-4  hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl ${s}`,...t,children:n});function Ae({onClick:n,className:s=""}){return e.jsxs("div",{className:`relative ${s}`,children:[e.jsx(y,{size:12,className:"absolute -top-1 -left-1 text-yellow-400 animate-ping",style:{animationDelay:"0s"}}),e.jsx(y,{size:10,className:"absolute -top-2 -right-1 text-pink-400 animate-ping",style:{animationDelay:"0.5s"}}),e.jsx(y,{size:8,className:"absolute -bottom-1 -left-2 text-blue-400 animate-ping",style:{animationDelay:"1s"}}),e.jsx(y,{size:14,className:"absolute -bottom-2 -right-2 text-purple-400 animate-ping",style:{animationDelay:"1.5s"}}),e.jsxs("button",{onClick:n,className:"relative group bg-primary p-2 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 animate-bounce cursor-pointer",style:{animationDuration:"2s",animationIterationCount:"infinite"},children:[e.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl opacity-0 group-hover:opacity-50 transition-opacity duration-300 blur-lg"}),e.jsx(k,{size:24,className:"text-white relative z-10 drop-shadow-sm"}),e.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl animate-pulse opacity-30"})]}),e.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20",children:"Â¡PromociÃ³n disponible!"})]})}const Xe=({setCart:n,hasPromotion:s,onPromotionClick:t,categorias:r,...a})=>{var g,w,b;const o=r==null?void 0:r.find(p=>p.id===(a==null?void 0:a.category_id)),d=()=>{n(p=>p.filter(i=>i.id!==(a==null?void 0:a.id)))},c=()=>{n(p=>p.map(i=>i.id===(a==null?void 0:a.id)?{...i,quantity:(i.quantity||1)+1}:i))},x=()=>{n(p=>p.map(i=>{if(i.id===(a==null?void 0:a.id)){const m=(i.quantity||1)-1;return m<=0?(d(a==null?void 0:a.id),null):{...i,quantity:m}}return i}).filter(Boolean))};return e.jsx("div",{className:"w-full bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center  justify-between gap-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/images/item/${a==null?void 0:a.image}`,alt:a==null?void 0:a.name,className:"w-20 h-20 object-cover rounded flex-shrink-0",onError:p=>p.target.src="/api/cover/thumbnail/null"}),s&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsx(Ae,{onClick:()=>t(a),className:"group"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-lg mb-2 line-clamp-2",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:[(g=a==null?void 0:a.brand)!=null&&g.name?"Marca: ":"CategorÃ­a: ",e.jsx("span",{className:"customtext-neutral-dark",children:(w=a==null?void 0:a.brand)!=null&&w.name?(b=a==null?void 0:a.brand)==null?void 0:b.name:o==null?void 0:o.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Disponibilidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[(a==null?void 0:a.stock)>=(a==null?void 0:a.quantity)?"En stock":"Agotado"," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:a==null?void 0:a.sku})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-between md:flex-col items-end md:items-end gap-4 mt-4 md:mt-0 flex-shrink-0",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number((a==null?void 0:a.price)*(a==null?void 0:a.quantity)).toFixed(2)]}),e.jsxs("div",{className:"font-bold text-lg",children:["S/ ",Number((a==null?void 0:a.final_price)*(a==null?void 0:a.quantity)).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:x,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:e.jsx(ye,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:(a==null?void 0:a.quantity)||1})}),e.jsx("button",{type:"button",onClick:c,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:e.jsx(ge,{size:16})})]}),e.jsx("button",{onClick:d,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(be,{size:18})})]})]})]})},a==null?void 0:a.id)},Ee="/api";class Ye{static async applyToCart(s,t,r=null){var a;try{if(console.log("ðŸ›’ Applying discount rules to cart:",{cartItems:s,totalAmount:t,customerEmail:r}),!Array.isArray(s)||s.length===0)return{success:!1,error:"Carrito vacÃ­o o invÃ¡lido",data:null};const o={cart_items:s.map(c=>{const x={item_id:String(c.item_id||c.id||""),quantity:parseInt(c.quantity)||1,price:parseFloat(c.price||c.final_price||0),name:String(c.name||c.description||"Producto sin nombre"),category_id:c.category_id?String(c.category_id):null};return console.log("ðŸ“¦ Processing cart item:",x),x}),total_amount:parseFloat(t)||0,customer_email:r||null};console.log("ðŸ“¤ Sending payload to API:",o);const d=await ve.post(`${Ee}/discount-rules/apply-to-cart`,o);return d.data.status===200?{success:!0,data:d.data.data,message:d.data.message}:{success:!1,error:d.data.message||"Error al aplicar descuentos",data:null}}catch(o){return console.error("Error applying discount rules:",o),(a=o.response)!=null&&a.data?{success:!1,error:o.response.data.message||"Error del servidor",data:o.response.data.data||null}:{success:!1,error:"Error de conexiÃ³n",data:null}}}static formatDiscounts(s){return!s||!Array.isArray(s)?[]:s.map(t=>({id:t.rule_id,name:t.rule_name||"Descuento automÃ¡tico",description:t.description||"",amount:parseFloat(t.discount_amount||0),type:t.discount_type||"fixed",promotion_type:t.promotion_type||null,free_items:t.free_items||[],formatted_amount:t.discount_type==="percentage"?`${t.discount_amount}%`:`S/ ${parseFloat(t.discount_amount||0).toFixed(2)}`}))}static getFreeItems(s){if(!s||!Array.isArray(s))return[];const t=[];return s.forEach(r=>{r.free_items&&Array.isArray(r.free_items)&&t.push(...r.free_items)}),t}static calculateTotalDiscount(s){return!s||!Array.isArray(s)?0:s.reduce((t,r)=>t+parseFloat(r.discount_amount||0),0)}}function Ze({isOpen:n,onClose:s,suggestion:t,onAddToCart:r,productName:a}){const[o,d]=l.useState(!1);if(!n||!t)return null;const c=async()=>{d(!0);try{console.log("Modal - suggestion data:",t),await r(t),s()}catch(x){console.error("Error adding promotional item:",x)}finally{d(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:s}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-300 scale-100",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors rounded-full hover:bg-gray-100",children:e.jsx(je,{size:20})}),e.jsxs("div",{className:"text-center pt-8 pb-6 px-6",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"animate-bounce",children:e.jsx(k,{size:48,className:"customtext-primary mx-auto"})}),e.jsx(y,{size:20,className:"absolute -top-2 -right-2 text-yellow-400 animate-pulse"}),e.jsx(y,{size:16,className:"absolute -bottom-1 -left-2 text-yellow-400 animate-pulse delay-300"})]}),e.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-2",children:"ðŸŽ‰ Â¡PromociÃ³n Especial!"}),e.jsx("p",{className:"text-gray-600",children:"Tienes un producto que califica para una promociÃ³n"})]}),e.jsxs("div",{className:"px-6 pb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Al tener  ",e.jsxs("span",{className:"font-semibold customtext-primary",children:[t.current_quantity," ",a]})," en tu carrito"]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsx("p",{className:"font-bold text-lg customtext-primary mb-1",children:t.rule_name}),e.jsx("p",{className:"text-sm customtext-neutral-light",children:t.description||"ObtÃ©n un producto gratis"})]})]})}),e.jsx("div",{className:"border-2 border-dashed rounded-xl p-4 mb-6 bg-green-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 w-9/12",children:[e.jsx("div",{className:"w-12 h-12  rounded-full flex items-center justify-center",children:e.jsx(k,{className:"customtext-primary",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold customtext-neutral-dark",children:t.item_name}),e.jsxs("p",{className:"text-sm customtext-primary",children:["Cantidad: ",t.suggested_quantity]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold customtext-primary",children:"Â¡GRATIS!"}),e.jsxs("p",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(t.value||0).toFixed(2)]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:c,disabled:o,className:"w-full bg-primary text-white font-semibold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",children:o?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Agregando..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(k,{size:20}),e.jsx("span",{children:"Â¡Agregar Regalo!"})]})}),e.jsx("button",{onClick:s,className:"w-full bg-gray-100 customtext-neutral-light font-medium py-3 px-6 rounded-xl hover:bg-gray-200 transition-colors duration-200",children:"Tal vez despuÃ©s"})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"* PromociÃ³n vÃ¡lida mientras tengas los productos requeridos en tu carrito"})]})]})})]})}var Ie=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Pe(n){var s=n.defaultOptions,t=s===void 0?!1:s,r=n.cacheOptions,a=r===void 0?!1:r,o=n.loadOptions;n.options;var d=n.isLoading,c=d===void 0?!1:d,x=n.onInputChange,g=n.filterOption,w=g===void 0?null:g,b=Ne(n,Ie),p=b.inputValue,i=l.useRef(void 0),m=l.useRef(!1),Q=l.useState(Array.isArray(t)?t:void 0),L=f(Q,2),W=L[0],M=L[1],X=l.useState(typeof p<"u"?p:""),T=f(X,2),$=T[0],C=T[1],Y=l.useState(t===!0),R=f(Y,2),Z=R[0],v=R[1],ee=l.useState(void 0),D=f(ee,2),A=D[0],E=D[1],ae=l.useState([]),V=f(ae,2),te=V[0],I=V[1],se=l.useState(!1),B=f(se,2),re=B[0],S=B[1],ne=l.useState({}),G=f(ne,2),j=G[0],J=G[1],oe=l.useState(void 0),U=f(oe,2),le=U[0],ie=U[1],ce=l.useState(void 0),H=f(ce,2),de=H[0],ue=H[1];a!==de&&(J({}),ue(a)),t!==le&&(M(Array.isArray(t)?t:void 0),ie(t)),l.useEffect(function(){return m.current=!0,function(){m.current=!1}},[]);var P=l.useCallback(function(N,h){if(!o)return h();var u=o(N,h);u&&typeof u.then=="function"&&u.then(h,function(){return h()})},[o]);l.useEffect(function(){t===!0&&P($,function(N){m.current&&(M(N||[]),v(!!i.current))})},[]);var pe=l.useCallback(function(N,h){var u=we(N,h,x);if(!u){i.current=void 0,C(""),E(""),I([]),v(!1),S(!1);return}if(a&&j[u])C(u),E(u),I(j[u]),v(!1),S(!1);else{var fe=i.current={};C(u),v(!0),S(!A),P(u,function(z){m&&fe===i.current&&(i.current=void 0,v(!1),E(u),I(z||[]),S(!1),J(z?_(_({},j),{},Se({},u,z)):j))})}},[a,P,A,j,x]),xe=re?[]:$&&A?te:W||[];return _(_({},b),{},{options:xe,isLoading:Z||c,onInputChange:pe,filterOption:w})}var ze=l.forwardRef(function(n,s){var t=Pe(n),r=_e(t);return l.createElement(ke,Oe({ref:s},r))}),ea=ze;class K{}q(K,"getShippingCost",async s=>{try{const{status:t,result:r}=await O.Fetch("./api/delivery-prices",{method:"POST",body:JSON.stringify(s)});if(!t)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}}),q(K,"getCosts",async s=>{try{const{status:t,result:r}=await O.Fetch("./api/prices-type",{method:"POST"});if(!t)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}});class aa{static async validateCoupon(s){try{const{status:t,result:r}=await O.Fetch("./api/coupons/validate",{method:"POST",body:JSON.stringify(s)});if(!t)throw new Error((r==null?void 0:r.message)||"Error al validar cupÃ³n");return r}catch(t){throw t}}static async generateCode(){try{const{status:s,result:t}=await O.Fetch("./api/coupons/generate-code",{method:"GET"});if(!s)throw new Error((t==null?void 0:t.message)||"Error al generar cÃ³digo");return t}catch(s){throw s}}}const ta=({title:n,description:s,selected:t,onSelect:r,disabled:a})=>e.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:r,children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${t?"border-primary":""}`,children:t&&e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),e.jsxs("div",{className:"customtext-neutral-light",children:[e.jsx("h4",{className:"text-sm ",children:n}),e.jsx("p",{className:"text-xs",children:s})]})]});export{ea as A,Qe as B,Xe as C,Ye as D,Ke as I,ta as O,Ze as P,We as a,K as b,aa as c};
